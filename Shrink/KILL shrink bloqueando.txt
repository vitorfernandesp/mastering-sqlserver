
DECLARE @QTD INT

WHILE 1=1
BEGIN
	SELECT @QTD = COUNT(*)
    	FROM SYS.DM_EXEC_REQUESTS 
    	WHERE
      	BLOCKING_SESSION_ID = 126 -- COLOQUE AQUI A SESSÃO UTILIZADA PELO SHRINK

      IF @QTD > 5 -- NÜMERO DE BLOQUEIOS, SE BLOQUEAR 1 OU MAIS SESSÕES O SHRINK SERÁ CANCELADO
      	BEGIN
            	EXEC ('KILL 126') -- COLOQUE AQUI TAMBÉM A SESSÃO DO SHRINK QUE SERÁ CANCELADA
            	RETURN
        	END         
	SET @QTD = 0 WAITFOR DELAY '00:00:01'
END